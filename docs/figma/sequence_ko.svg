<svg width="1600" height="540" viewBox="0 0 1600 540" xmlns="http://www.w3.org/2000/svg">
  <style>
    .t1 { font: 700 22px/1.3 Inter, 'Noto Sans KR', sans-serif; fill:#0f172a; }
    .t2 { font: 500 16px/1.3 Inter, 'Noto Sans KR', sans-serif; fill:#334155; }
    .card { rx:12; stroke:#1f2937; stroke-opacity:.2; stroke-width:2; }
    .blue { fill:#D9E8FF; } .amber { fill:#FFE8C6; }
    .pink { fill:#FAD2D7; } .green { fill:#CDE8D1; }
    .indigo { fill:#D9D6FE; }
  </style>
  <text class="t1" x="800" y="48" text-anchor="middle">데이터 흐름 — 의미전송 이벤트 시퀀스</text>

  <!-- Lifelines -->
  <g>
    <rect class="card blue" x="60" y="80" width="200" height="60"/>
    <text class="t1" x="160" y="117" text-anchor="middle">센서</text>
    <line x1="160" y1="140" x2="160" y2="480" stroke="#94a3b8" stroke-dasharray="6 6"/>
  </g>
  <g>
    <rect class="card amber" x="320" y="80" width="220" height="60"/>
    <text class="t1" x="430" y="117" text-anchor="middle">엣지 센서(예측·잔차)</text>
    <line x1="430" y1="140" x2="430" y2="480" stroke="#94a3b8" stroke-dasharray="6 6"/>
  </g>
  <g>
    <rect class="card pink" x="620" y="80" width="200" height="60"/>
    <text class="t1" x="720" y="117" text-anchor="middle">정책 에이전트</text>
    <line x1="720" y1="140" x2="720" y2="480" stroke="#94a3b8" stroke-dasharray="6 6"/>
  </g>
  <g>
    <rect class="card green" x="900" y="80" width="200" height="60"/>
    <text class="t1" x="1000" y="117" text-anchor="middle">업로더(MQTT)</text>
    <line x1="1000" y1="140" x2="1000" y2="480" stroke="#94a3b8" stroke-dasharray="6 6"/>
  </g>
  <g>
    <rect class="card indigo" x="1180" y="80" width="200" height="60"/>
    <text class="t1" x="1280" y="117" text-anchor="middle">브로커/수집기</text>
    <line x1="1280" y1="140" x2="1280" y2="480" stroke="#94a3b8" stroke-dasharray="6 6"/>
  </g>

  <!-- Messages -->
  <g stroke="#0f172a">
    <line x1="160" y1="180" x2="430" y2="180" stroke-width="3" marker-end="url(#arr)"/>
    <text class="t2" x="295" y="168" text-anchor="middle">샘플 수집</text>

    <line x1="430" y1="220" x2="430" y2="230" stroke-width="3"/>
    <text class="t2" x="430" y="214" text-anchor="middle">예측·잔차 |e| 계산</text>

    <line x1="430" y1="260" x2="720" y2="260" stroke-width="3" marker-end="url(#arr)"/>
    <text class="t2" x="575" y="248" text-anchor="middle">잔차·AoI·링크 보고</text>

    <line x1="720" y1="300" x2="430" y2="300" stroke-width="3" marker-end="url(#arr)"/>
    <text class="t2" x="575" y="288" text-anchor="middle">τ, k 결정(LinUCB)</text>

    <line x1="430" y1="340" x2="1000" y2="340" stroke-width="3" marker-end="url(#arr)"/>
    <text class="t2" x="715" y="328" text-anchor="middle">|e| > τ → 이벤트 페이로드(양자화 k)</text>

    <line x1="1000" y1="380" x2="1280" y2="380" stroke-width="3" marker-end="url(#arr)"/>
    <text class="t2" x="1140" y="368" text-anchor="middle">QoS1 발행 → 브로커 전달</text>

    <line x1="1280" y1="420" x2="1000" y2="420" stroke-width="3" marker-end="url(#arr)"/>
    <text class="t2" x="1140" y="408" text-anchor="middle">Ack / 수집기 집계(AoI·MAE·Rate)</text>
  </g>

  <defs>
    <marker id="arr" markerWidth="12" markerHeight="12" refX="10" refY="6" orient="auto">
      <path d="M0,0 L12,6 L0,12 z" fill="#0f172a"/>
    </marker>
  </defs>
</svg>
